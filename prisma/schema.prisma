datasource db {
  provider = "mongodb"
  url      = env("DATABASE_URL")
}

generator client {
  provider = "prisma-client-js"
}

model User {
  id        String   @id @default(auto()) @map("_id") @db.ObjectId
  email     String   @unique
  username  String   @unique
  fullname  String
  avatarURL String?  
  password  String
  lastPasswordChange DateTime?
  role      Role     @default(STUDENT)
  createdAt DateTime @default(now())
  posts     BlogPost[] @relation("userBlogPosts")
  events     Event[] @relation("userEvents")
  attachments  Attachment[] @relation("userAttachments")
  publications  Publication[] @relation("userPublications")
}

model Attachment {
  id        String   @id @default(auto()) @map("_id") @db.ObjectId
  userId    String   @db.ObjectId
  user      User     @relation("userAttachments", fields: [userId], references: [id])
  extension String
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model BlogPost {
  id        String   @id @default(auto()) @map("_id") @db.ObjectId
  createdAt DateTime @default(now())
  updatedAt DateTime? @updatedAt
  published Boolean  @default(false)
  title     String
  content   String
  imageURL  String?
  author    User?    @relation("userBlogPosts", fields: [authorId], references: [id])
  authorId  String   @db.ObjectId
}

model Event {
  id        String   @id @default(auto()) @map("_id") @db.ObjectId
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
  published Boolean  @default(false)
  title     String
  content   String
  imageURL  String?
  registerLink  String
  location  String
  date      DateTime 
  author    User?    @relation("userEvents", fields: [authorId], references: [id])
  authorId  String   @db.ObjectId
}

model Activity {
  id          String         @id @default(auto()) @map("_id") @db.ObjectId
  type        ActivityType   @default(COMPETITION)
  name        String
  description String?
  date        DateTime?
  teams       Team[]         @relation("activityTeams")
  photos      String[]

  createdAt  DateTime @default(now())
  updatedAt  DateTime @updatedAt
}


model Team {
  id         String     @id @default(auto()) @map("_id") @db.ObjectId
  name       String?
  activityId String       @db.ObjectId
  activity   Activity  @relation("activityTeams", fields: [activityId], references: [id])
  members    String[]

  createdAt  DateTime @default(now())
  updatedAt  DateTime @updatedAt
}

model Message {
    id        String   @id @default(auto()) @map("_id") @db.ObjectId
    name      String
    email     String
    phone     String
    content   String
    replied   Boolean
    createdAt DateTime @default(now())
}



model NewsLetter {
    id        String   @id @default(auto()) @map("_id") @db.ObjectId
    email     String   @unique
    unsubscribeToken   String   @default("")
    subscribedAt DateTime @default(now())
}


model Publication {
    id        String   @id @default(auto()) @map("_id") @db.ObjectId
  title       String
  type        PublicationType
  status      Status       
  author    User?    @relation("userPublications", fields: [authorId], references: [id])
  authorId  String   @db.ObjectId
  createdAt   DateTime      @default(now())
  updatedAt   DateTime      @updatedAt
}


enum PublicationType {
  RESEARCH_PAPER
  JOURNAL_ARTICLE
  BLOG_POST
  CONFERENCE_PAPER
  BOOK_CHAPTER
  CASE_STUDY
  WHITE_PAPER
  THESIS
  DISSERTATION
  TECHNICAL_REPORT
}


enum ResearchField {
  COMPUTER_SCIENCE
  ARTIFICIAL_INTELLIGENCE
  ENGINEERING
  MEDICAL_SCIENCES
  SOCIAL_SCIENCES
  ECONOMICS
  ENVIRONMENTAL_SCIENCES
  PSYCHOLOGY
  BUSINESS
  PHYSICS
  CHEMISTRY
  BIOLOGY
}


enum Status {
  DRAFT
  SUBMITTED
  REVIEWED
  APPROVED
  IN_PROGRESS
  COMPLETED
  PUBLISHED
  REJECTED
}



enum Role {
  STUDENT
  TEACHER
  MENTOR
  RESEARCHER
  COORDINATOR
  ADMIN
  STAFF
  PARTNER
  VOLUNTEER
  ALUMNI
}

enum EventType {
  WEBINAR
  WORKSHOP
  MENTORSHIP_SESSION
  HACKATHON
  CONFERENCE
  NETWORKING_EVENT
}

enum ResourceType {
  DATASET
  RESEARCH_PAPER_TEMPLATE
  STATISTICAL_SOFTWARE_TUTORIAL
  PRESENTATION_TEMPLATE
  CITATION_TOOL
}



enum ActivityType {
  COMPETITION
  PROGRAM
  CLUB
}